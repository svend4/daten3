# Manual Penetration Testing Checklist

## üéØ Overview

This checklist covers manual penetration testing procedures for IOS System.

**Tester:** [Name]  
**Date:** [Date]  
**Version:** [App Version]  
**Environment:** [Staging/Production]

---

## üîê AUTHENTICATION & SESSION MANAGEMENT

### Login Security

- [ ] **Brute Force Protection**
  - Attempt 10+ failed logins
  - Verify account lockout after X attempts
  - Check for CAPTCHA after N failures
  - Test: `for i in {1..20}; do curl -X POST /api/auth/login -d '{"username":"admin","password":"wrong"}'; done`

- [ ] **Password Policy**
  - Try weak passwords (123456, password, etc.)
  - Verify minimum length (8+ characters)
  - Check complexity requirements
  - Test password history (can't reuse last 5)

- [ ] **MFA Bypass**
  - Try accessing protected resources without MFA
  - Test MFA code expiration (should expire after 5 min)
  - Attempt MFA code reuse
  - Test backup codes

- [ ] **Session Security**
  - Check session token randomness (entropy)
  - Verify HttpOnly flag on cookies
  - Verify Secure flag on cookies (HTTPS only)
  - Check SameSite attribute
  - Test session fixation vulnerability
  - Test concurrent session limits

- [ ] **Logout**
  - Verify session invalidation on logout
  - Check token revocation
  - Test "logout everywhere" functionality

### OAuth Security

- [ ] **OAuth Flow**
  - Verify state parameter validation (CSRF protection)
  - Check redirect_uri whitelist
  - Test authorization code reuse (should fail)
  - Verify PKCE implementation

- [ ] **Token Security**
  - Check access token expiration (15 min)
  - Check refresh token expiration (30 days)
  - Verify token rotation on refresh
  - Test token revocation

---

## üõ°Ô∏è AUTHORIZATION & ACCESS CONTROL

### RBAC Testing

- [ ] **Horizontal Privilege Escalation**
  - User A tries to access User B's documents
  - Test: `curl /api/documents/USER_B_DOC_ID -H "Authorization: Bearer USER_A_TOKEN"`
  - Expected: 403 Forbidden

- [ ] **Vertical Privilege Escalation**
  - Regular user tries admin endpoints
  - Test: `curl /api/admin/users -H "Authorization: Bearer USER_TOKEN"`
  - Expected: 403 Forbidden

- [ ] **Direct Object Reference**
  - Test sequential ID enumeration
  - Try accessing documents by guessing IDs
  - Verify UUID/random ID usage

- [ ] **API Endpoint Protection**
  - List all endpoints: `curl /api/docs`
  - Verify authentication required
  - Check role-based access

### Permission Testing

- [ ] **Document Permissions**
  - Create document as User A
  - Try to edit as User B (should fail)
  - Try to delete as User B (should fail)
  - Test sharing permissions

- [ ] **Domain Permissions**
  - Try creating domain without permission
  - Try modifying domain hierarchy
  - Test cascade permissions

---

## üíâ INJECTION ATTACKS

### SQL Injection

- [ ] **Authentication Bypass**
  - Username: `admin' OR '1'='1`
  - Password: `' OR '1'='1`
  - Expected: Login fails

- [ ] **Search Injection**
  - Query: `'; DROP TABLE documents; --`
  - Query: `' UNION SELECT * FROM users --`
  - Expected: Query sanitized, no execution

- [ ] **Blind SQL Injection**
  - Query: `test' AND 1=1 --` (should return results)
  - Query: `test' AND 1=2 --` (should return no results)
  - If different results ‚Üí vulnerable

### NoSQL Injection

- [ ] **MongoDB Injection**
  - Test: `{"username": {"$ne": null}, "password": {"$ne": null}}`
  - Test: `{"username": {"$gt": ""}, "password": {"$gt": ""}}`

### Command Injection

- [ ] **OS Command Injection**
  - Test file upload with: `; ls -la`
  - Test export filename: `report.pdf; cat /etc/passwd`
  - Test webhook URL: `http://evil.com; curl evil.com`

### LDAP Injection

- [ ] **LDAP Query Injection** (if LDAP used)
  - Username: `*)(uid=*))(|(uid=*`
  - Test: `admin*` (wildcard)

---

## üîì AUTHENTICATION VULNERABILITIES

### Password Reset

- [ ] **Reset Token Security**
  - Check token randomness (should be UUID)
  - Test token expiration (should expire in 15 min)
  - Try reusing token (should fail)
  - Test token enumeration

- [ ] **Account Enumeration**
  - Reset with valid email: "Reset link sent"
  - Reset with invalid email: Should show same message
  - Verify timing is consistent

### Account Recovery

- [ ] **Security Questions**
  - If used, test weak questions
  - Check for brute force protection
  - Verify lockout mechanism

---

## üåê WEB VULNERABILITIES

### Cross-Site Scripting (XSS)

- [ ] **Reflected XSS**
  - Search: `<script>alert('XSS')</script>`
  - URL param: `?name=<img src=x onerror=alert(1)>`
  - Expected: Input sanitized

- [ ] **Stored XSS**
  - Document content: `<script>alert(document.cookie)</script>`
  - Comment: `<svg onload=alert(1)>`
  - Username: `<img src=x onerror=alert(1)>`

- [ ] **DOM-based XSS**
  - Check client-side JavaScript
  - Test: `#<script>alert(1)</script>`

### Cross-Site Request Forgery (CSRF)

- [ ] **CSRF Token Validation**
  - Remove CSRF token from request
  - Use token from another session
  - Change request method (POST ‚Üí GET)

- [ ] **State-Changing Operations**
  - Test password change without token
  - Test document delete without token
  - Test profile update without token

### Clickjacking

- [ ] **X-Frame-Options Header**
  - Check header: `X-Frame-Options: DENY`
  - Try embedding in iframe
  - Test `Content-Security-Policy: frame-ancestors 'none'`

### Security Headers

- [ ] **HTTP Security Headers**
  ```bash
  curl -I https://api.ios-system.com
  ```
  - [ ] `Strict-Transport-Security: max-age=31536000`
  - [ ] `X-Content-Type-Options: nosniff`
  - [ ] `X-Frame-Options: DENY`
  - [ ] `Content-Security-Policy: ...`
  - [ ] `Referrer-Policy: no-referrer-when-downgrade`
  - [ ] `Permissions-Policy: ...`

---

## üì§ FILE UPLOAD VULNERABILITIES

### Malicious File Upload

- [ ] **File Type Validation**
  - Upload .php file (should be rejected)
  - Upload .exe file (should be rejected)
  - Upload double extension: `image.jpg.php`

- [ ] **File Content Validation**
  - Rename malicious file to .jpg
  - Check MIME type validation
  - Test polyglot files (valid image + code)

- [ ] **Path Traversal**
  - Filename: `../../../../etc/passwd`
  - Filename: `..\..\..\..\windows\system32\config\sam`

- [ ] **File Size Limits**
  - Upload 100MB file (should be rejected)
  - Test ZIP bomb
  - Test resource exhaustion

### File Download Vulnerabilities

- [ ] **Path Traversal**
  - Download: `/api/files/../../etc/passwd`
  - Download: `/api/files/..%2F..%2Fetc%2Fpasswd`

- [ ] **Access Control**
  - Try downloading other user's files
  - Test: `/api/files/USER_B_FILE_ID`

---

## üîç INFORMATION DISCLOSURE

### Error Messages

- [ ] **Verbose Errors**
  - Trigger 500 error
  - Check for stack traces
  - Look for database errors
  - Test: `curl /api/documents/INVALID_ID`

### Debug Information

- [ ] **Debug Endpoints**
  - Try: `/debug`, `/phpinfo`, `/info`
  - Check: `/.git`, `/.env`, `/config`
  - Test: `/.well-known/`

### API Information

- [ ] **API Documentation**
  - Check `/api/docs` accessibility
  - Verify authentication required
  - Test Swagger/OpenAPI exposure

### Server Information

- [ ] **Server Headers**
  ```bash
  curl -I https://api.ios-system.com | grep Server
  ```
  - Server version should be hidden
  - Check `X-Powered-By` (should not exist)

---

## üöÄ BUSINESS LOGIC VULNERABILITIES

### Rate Limiting

- [ ] **API Rate Limits**
  - Send 1000 requests in 1 minute
  - Check for `429 Too Many Requests`
  - Test different endpoints

- [ ] **Search Rate Limiting**
  - Perform 100 searches rapidly
  - Check for rate limit

### Input Validation

- [ ] **Integer Overflow**
  - Price: `999999999999999999999`
  - Quantity: `-1`
  - Limit: `9999999`

- [ ] **Business Rule Bypass**
  - Try negative prices
  - Test zero prices
  - Check minimum/maximum limits

---

## üîê CRYPTOGRAPHY

### Password Storage

- [ ] **Password Hashing**
  - Check database: passwords should be bcrypt/argon2
  - Verify salt is unique per password
  - Check work factor (bcrypt cost ‚â• 12)

### Data Encryption

- [ ] **Sensitive Data**
  - Check database encryption (field-level)
  - Verify TLS/SSL for data in transit
  - Test encryption key management

### SSL/TLS

- [ ] **Certificate Validation**
  - Check certificate expiration
  - Verify certificate chain
  - Test: `openssl s_client -connect api.ios-system.com:443`

- [ ] **SSL Configuration**
  - Test: https://www.ssllabs.com/ssltest/
  - Target grade: A or A+
  - No weak ciphers (RC4, 3DES)

---

## üìù REPORTING TEMPLATE

### Critical Vulnerability Report

**Title:** [Vulnerability Name]

**Severity:** Critical/High/Medium/Low

**CVSS Score:** [Calculate at https://www.first.org/cvss/calculator/3.1]

**Description:**
[Detailed description]

**Steps to Reproduce:**
1. Step 1
2. Step 2
3. Step 3

**Proof of Concept:**